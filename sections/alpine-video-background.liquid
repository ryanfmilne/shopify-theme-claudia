{%- liquid
  assign section_height = section.settings.height
  assign video_file = section.settings.video_file
  assign video_link = section.settings.video_link
  assign tuck_behind_header = section.settings.tuck_behind_header
  assign header_total_height = 110
-%}

<section
  class="relative w-full overflow-hidden {% if tuck_behind_header %}-mt-[110px] pt-[110px]{% endif %}"
  style="height: {% if tuck_behind_header %}100vh{% else %}{{ section_height }}px{% endif %};"
  {{ section.shopify_attributes }}
>

  {%- comment -%} Optional Clickable Overlay Link {%- endcomment -%}
  {%- if video_link != blank -%}
    <a
      href="{{ video_link }}"
      class="absolute inset-0 z-0 cursor-pointer"
      aria-label="View more"
    >
      <span class="sr-only">Navigate to {{ video_link }}</span>
    </a>
  {%- endif -%}

  {%- comment -%} Video Background {%- endcomment -%}
  {%- if video_file != blank -%}
    <video
      autoplay
      muted
      loop
      playsinline
      class="absolute inset-0 w-full h-full object-cover"
      aria-hidden="true"
    >
      {%- for source in video_file.sources -%}
        <source src="{{ source.url }}" type="{{ source.mime_type }}">
      {%- endfor -%}
      Your browser does not support the video tag.
    </video>
  {%- endif -%}

</section>

{% schema %}
{
  "name": "Alpine Video Background",
  "class": "section-alpine-video-background",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "video",
      "id": "video_file",
      "label": "Background video"
    },
    {
      "type": "url",
      "id": "video_link",
      "label": "Section link (optional)",
      "info": "Makes the entire video section clickable"
    },
    {
      "type": "checkbox",
      "id": "tuck_behind_header",
      "label": "Tuck behind header",
      "default": false,
      "info": "Video extends to full viewport height and appears behind the header. Works best with transparent header mode."
    },
    {
      "type": "range",
      "id": "height",
      "label": "Section height",
      "min": 400,
      "max": 800,
      "step": 50,
      "unit": "px",
      "default": 600,
      "info": "Height when not tucked behind header"
    }
  ],
  "presets": [
    {
      "name": "Alpine Video Background",
      "category": "Custom"
    }
  ]
}
{% endschema %}
