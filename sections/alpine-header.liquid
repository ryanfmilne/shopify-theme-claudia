{%- liquid
  assign logo_height = section.settings.logo_height
  assign sticky_header = section.settings.sticky_header
  assign transparent_header = section.settings.transparent_header
-%}

<div x-data="alpineHeader({{ sticky_header }}, {{ transparent_header }})">
  {%- comment -%} Spacer to prevent content jump when header becomes fixed {%- endcomment -%}
  <div
    x-show="isSticky && stickyEnabled"
    class="h-[70px] lg:h-[80px]"
    style="display: none;"
  ></div>

  <header
    x-ref="header"
    x-cloak
    :class="{
      'fixed top-0 left-0 right-0 z-50': isSticky && stickyEnabled,
      'relative z-50': !isSticky || !stickyEnabled,
      'bg-transparent text-white border-transparent': transparentMode && !isSticky,
      'bg-white text-gray-900 border-gray-200 shadow-sm': !transparentMode || isSticky
    }"
    class="border-b transition-all duration-[350ms] ease-in-out"
    style="font-family: Untitled Sans, Helvetica, sans-serif;"
    {{ section.shopify_attributes }}
  >
  <div class="page-width">
    <div class="grid grid-cols-3 items-center h-[70px] lg:h-[80px] gap-4">

      {%- comment -%} LEFT COLUMN: Navigation Links (Desktop) / Hamburger Menu (Mobile) {%- endcomment -%}
      <div class="flex items-center justify-start">
        {%- comment -%} Hamburger Menu (Mobile Only) {%- endcomment -%}
        <button
          @click="toggleMobileMenu()"
          :class="{
            'text-white hover:text-gray-200': transparentMode && !isSticky,
            'text-gray-800 hover:text-gray-600': !transparentMode || isSticky
          }"
          class="lg:hidden p-2 -ml-2 focus:outline-none transition-colors duration-[250ms] ease-in-out"
          aria-label="Toggle mobile menu"
          :aria-expanded="mobileMenuOpen"
        >
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
          </svg>
        </button>

        {%- comment -%} Desktop Navigation Links {%- endcomment -%}
        <nav class="hidden lg:!flex items-center gap-12">
          <a
            href="/collections/all"
            :class="{
              'text-white hover:text-gray-200': transparentMode && !isSticky,
              'text-black hover:text-gray-700': !transparentMode || isSticky
            }"
            class="text-[12px] font-extralight hover:underline underline-offset-4 transition-colors duration-[250ms] ease-in-out"
          >
            Shop
          </a>

          <a
            href="/collections/new"
            :class="{
              'text-white hover:text-gray-200': transparentMode && !isSticky,
              'text-black hover:text-gray-700': !transparentMode || isSticky
            }"
            class="text-[12px] font-extralight hover:underline underline-offset-4 transition-colors duration-[250ms] ease-in-out"
          >
            New
          </a>

          <a
            href="/collections/bestsellers"
            :class="{
              'text-white hover:text-gray-200': transparentMode && !isSticky,
              'text-black hover:text-gray-700': !transparentMode || isSticky
            }"
            class="text-[12px] font-extralight hover:underline underline-offset-4 transition-colors duration-[250ms] ease-in-out"
          >
            Bestsellers
          </a>

          <a
            href="/pages/about"
            :class="{
              'text-white hover:text-gray-200': transparentMode && !isSticky,
              'text-black hover:text-gray-700': !transparentMode || isSticky
            }"
            class="text-[12px] font-extralight hover:underline underline-offset-4 transition-colors duration-[250ms] ease-in-out"
          >
            About
          </a>
        </nav>
      </div>

      {%- comment -%} CENTER COLUMN: Logo {%- endcomment -%}
      <div class="flex items-center justify-center">
        <a href="{{ routes.root_url }}" class="block">
          {%- if settings.logo != blank -%}
            {%- assign logo_alt = settings.logo.alt | default: shop.name | escape -%}
            <div
              :class="{ 'brightness-0 invert': transparentMode && !isSticky }"
              class="transition-all duration-[350ms] ease-in-out"
              style="height: {{ logo_height }}px;"
            >
              {{ settings.logo | image_url: width: 300 | image_tag:
                class: 'h-full w-auto',
                alt: logo_alt,
                loading: 'eager'
              }}
            </div>
          {%- else -%}
            <span class="font-heading text-2xl font-bold">{{ shop.name }}</span>
          {%- endif -%}
        </a>
      </div>

      {%- comment -%} RIGHT COLUMN: Search, Account, Cart {%- endcomment -%}
      <div class="flex items-center justify-end gap-12">

        {%- comment -%} Search Link {%- endcomment -%}
        <a
          href="{{ routes.search_url }}"
          :class="{
            'text-white hover:text-gray-200': transparentMode && !isSticky,
            'text-black hover:text-gray-700': !transparentMode || isSticky
          }"
          class="text-[12px] font-extralight hover:underline underline-offset-4 transition-colors duration-[250ms] ease-in-out"
        >
          Search
        </a>

        {%- comment -%} Favorites Link {%- endcomment -%}
        <a
          href="/pages/favorites"
          :class="{
            'text-white hover:text-gray-200': transparentMode && !isSticky,
            'text-black hover:text-gray-700': !transparentMode || isSticky
          }"
          class="text-[12px] font-extralight hover:underline underline-offset-4 transition-colors duration-[250ms] ease-in-out"
        >
          Favorites
        </a>

        {%- comment -%} Account Link {%- endcomment -%}
        <a
          href="{{ routes.account_url }}"
          :class="{
            'text-white hover:text-gray-200': transparentMode && !isSticky,
            'text-black hover:text-gray-700': !transparentMode || isSticky
          }"
          class="text-[12px] font-extralight hover:underline underline-offset-4 transition-colors duration-[250ms] ease-in-out"
        >
          Account
        </a>

        {%- comment -%} Cart Link with Count {%- endcomment -%}
        <a
          href="{{ routes.cart_url }}"
          :class="{
            'text-white hover:text-gray-200': transparentMode && !isSticky,
            'text-black hover:text-gray-700': !transparentMode || isSticky
          }"
          class="text-[12px] font-extralight hover:underline underline-offset-4 transition-colors duration-[250ms] ease-in-out"
        >
          Cart ({{ cart.item_count }})
        </a>

      </div>

    </div>
  </div>

  {%- comment -%} MOBILE MENU DRAWER {%- endcomment -%}
  <div
    x-show="mobileMenuOpen"
    x-transition:enter="transition ease-out duration-300"
    x-transition:enter-start="opacity-0"
    x-transition:enter-end="opacity-100"
    x-transition:leave="transition ease-in duration-200"
    x-transition:leave-start="opacity-100"
    x-transition:leave-end="opacity-0"
    @click="closeMobileMenu()"
    class="fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden"
    style="display: none;"
  ></div>

  <nav
    x-show="mobileMenuOpen"
    x-transition:enter="transition ease-out duration-300 transform"
    x-transition:enter-start="-translate-x-full"
    x-transition:enter-end="translate-x-0"
    x-transition:leave="transition ease-in duration-200 transform"
    x-transition:leave-start="translate-x-0"
    x-transition:leave-end="-translate-x-full"
    @click.outside="closeMobileMenu()"
    class="fixed top-0 left-0 h-full w-80 max-w-[85vw] bg-white shadow-xl z-50 overflow-y-auto lg:hidden"
    style="display: none;"
  >
    <div class="flex flex-col h-full">
      {%- comment -%} Mobile Menu Header {%- endcomment -%}
      <div class="flex items-center justify-between p-4 border-b border-gray-200">
        <span class="font-heading text-xl font-bold text-gray-900">Menu</span>
        <button
          @click="closeMobileMenu()"
          class="p-2 -mr-2 text-gray-800 hover:text-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-300 rounded"
          aria-label="Close menu"
        >
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
          </svg>
        </button>
      </div>

      {%- comment -%} Mobile Menu Links {%- endcomment -%}
      <div class="flex-1 py-4">
        {%- if section.settings.menu != blank -%}
          <ul class="space-y-1">
            {%- for link in section.settings.menu.links -%}
              <li>
                <a
                  href="{{ link.url }}"
                  class="block px-6 py-3 text-base font-medium text-gray-900 hover:bg-gray-100 transition-colors"
                  @click="closeMobileMenu()"
                >
                  {{ link.title }}
                </a>
              </li>
            {%- endfor -%}
          </ul>
        {%- else -%}
          {%- comment -%} Placeholder links if no menu is selected {%- endcomment -%}
          <ul class="space-y-1">
            <li>
              <a href="/" class="block px-6 py-3 text-base font-medium text-gray-900 hover:bg-gray-100" @click="closeMobileMenu()">Home</a>
            </li>
            <li>
              <a href="/collections/all" class="block px-6 py-3 text-base font-medium text-gray-900 hover:bg-gray-100" @click="closeMobileMenu()">Shop</a>
            </li>
            <li>
              <a href="/pages/about" class="block px-6 py-3 text-base font-medium text-gray-900 hover:bg-gray-100" @click="closeMobileMenu()">About</a>
            </li>
            <li>
              <a href="/pages/contact" class="block px-6 py-3 text-base font-medium text-gray-900 hover:bg-gray-100" @click="closeMobileMenu()">Contact</a>
            </li>
          </ul>
        {%- endif -%}
      </div>
    </div>
  </nav>
  </header>
</div>

{% schema %}
{
  "name": "Alpine Header",
  "class": "section-alpine-header",
  "settings": [
    {
      "type": "link_list",
      "id": "menu",
      "label": "Menu",
      "default": "main-menu",
      "info": "Navigation menu for mobile and desktop"
    },
    {
      "type": "range",
      "id": "logo_height",
      "label": "Logo height",
      "min": 20,
      "max": 60,
      "step": 5,
      "unit": "px",
      "default": 40
    },
    {
      "type": "checkbox",
      "id": "transparent_header",
      "label": "Transparent header",
      "default": false,
      "info": "Header has transparent background with light text. Transitions to solid white on scroll. Works best with video background tucked behind header."
    },
    {
      "type": "checkbox",
      "id": "sticky_header",
      "label": "Enable sticky header",
      "default": true,
      "info": "Header becomes sticky when it reaches the top of the browser while scrolling"
    }
  ],
  "presets": [
    {
      "name": "Alpine Header",
      "category": "Custom"
    }
  ]
}
{% endschema %}
